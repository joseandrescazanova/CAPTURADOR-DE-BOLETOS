# config/config.yaml - CONFIGURACIÓN OPTIMIZADA

camara:
  id_dispositivo: 0
  resolucion_captura: [1920, 1080]  # Full HD - más estable
  resolucion_vista: [1280, 720]     # 720p para vista previa
  fps: 30                           # 30 FPS para Full HD
  modo_color: "bgr"
  brillo: 0
  contraste: 0
  # Nuevo parámetro: detección automática de resolución
  deteccion_automatica_resolucion: true
  
procesamiento:
  # Parámetros para el procesamiento de imágenes
  umbral_calidad: 0.7              # Umbral mínimo de confianza para considerar una captura válida (0.0-1.0)
  
  # Región del código de barras (coordenadas relativas: 0.0 a 1.0)
  # x, y: esquina superior izquierda; ancho, alto: dimensiones relativas
  region_barras:
    x: 0.10        # 10% desde izquierda (no 5%)
    y: 0.80        # 80% desde arriba (código en parte inferior)
    ancho: 0.80    # 80% del ancho
    alto: 0.15     # 15% del alto (432px → 324px, más realista)
  
  # Filtros a aplicar a la imagen del código de barras antes de decodificar
  filtros:
    - "ecualizacion"      # Ecualización de histograma para mejorar contraste
    - "suavizado"         # Suavizado gaussiano para reducir ruido
  
  # Estrategia de búsqueda si no se encuentra en la región esperada
  busqueda_robusta: true  # Activar búsqueda automática del código de barras

archivos:
  # Configuración de guardado de archivos
  ruta_base: "./proyecto/boletos"  # Ruta base donde se crearán las carpetas por código
  
  # NUEVO: Estructura de directorios
  # false: todos los archivos en ruta_base
  # "fecha": organizar por fecha (YYYY-MM-DD)
  # "codigo": organizar por código de barras decodificado
  estructura_directorios: "codigo"
  
  # Permitir caracteres especiales en nombres de carpetas
  # Si el código contiene caracteres no válidos para nombres de carpeta
  sanitizar_nombre_carpeta: true
  caracteres_reemplazo: "_"
  
  # Si se usa estructura por fecha, puedes mantener esto:
  formato_fecha: "%Y-%m-%d"  # Formato para carpetas por fecha
  
  # Formato para guardar imágenes
  formato_imagen: "jpg"
  calidad_jpg: 90
  
  # Qué guardar
  guardar_fallidas: false
  guardar_roi: true
  
  # Estructura de nombres de archivo dentro de cada carpeta
  # Patrones disponibles: {tipo}, {codigo}, {timestamp}, {indice}, {fecha}
  nombre_frente: "frente_{timestamp}"
  nombre_reverso: "reverso_{timestamp}"
  nombre_roi: "roi_{timestamp}"
  nombre_metadata: "metadata_{timestamp}"
  nombre_fallida: "fallida_{timestamp}"
  
  # NUEVO: Para evitar conflictos con múltiples boletos del mismo código
  # Si es true, añade índice cuando ya existe una carpeta
  evitar_sobreescritura: true

ui:
  # Configuración de la interfaz de usuario
  tema: "oscuro"
  mostrar_timestamp: true
  feedback_sonido: false
  
  # Tamaños y dimensiones
  tamano_miniatura: [320, 240]
  actualizacion_ms: 33

logging:
  # Configuración del sistema de logging
  nivel_consola: "INFO"
  nivel_archivo: "DEBUG"
  ruta_logs: "./logs"
  max_mb_log: 10
  dias_a_conservar: 30

desarrollo:
  modo_depuracion: false
  simular_camara: false
  ruta_imagen_simulada: "./assets/test_boleto.jpg"